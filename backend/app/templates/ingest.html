{% extends "base.html" %}
{% block title %}Ingest · AIr4{% endblock %}

{% block content %}
<style>
/* ——— Ingest (scoped) ——— */
.ing-wrap{max-width:1040px;margin:32px auto 56px;padding:0 20px}
.ing-h{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:14px}
.ing-h .t{font:600 26px/1.2 system-ui, -apple-system, Segoe UI, Inter, sans-serif}
.ing-h .s{color:#a9b2c5;font-size:13px;margin-top:4px}

.ing-card{background:linear-gradient(180deg,rgba(23,30,48,.78),rgba(18,24,40,.78));
  border:1px solid rgba(145,170,220,.16);border-radius:16px;
  box-shadow:0 14px 38px rgba(0,0,0,.34),0 0 0 1px rgba(255,255,255,.04) inset;
  padding:18px 20px;margin-bottom:18px}
.ing-row{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px}
.ing-muted{color:#bcc4d3;font-size:13px}
.ing-actions{display:flex;gap:10px;flex-wrap:wrap}

.ing-pill{border:1px solid rgba(145,170,220,.16);background:rgba(255,255,255,.08);color:#eaf0ff;
  border-radius:999px;padding:8px 14px;font-size:13px;cursor:pointer;
  transition:transform .08s, background .2s, box-shadow .2s}
.ing-pill:hover{transform:translateY(-1px);background:rgba(255,255,255,.12)}

.ing-pre{margin:0;padding:10px 12px;border-radius:12px;background:rgba(0,0,0,.22);
  border:1px solid rgba(145,170,220,.16);font:12px/1.45 ui-monospace,Menlo,monospace;color:#eaf0ff}

.ing-grid{display:grid;gap:14px}.ing-two{grid-template-columns:1fr 1fr}
@media (max-width:980px){.ing-two{grid-template-columns:1fr}}

.ing-label{font-size:12px;color:#a7b2c7;margin:6px 0}
.ing-input{width:100%;height:42px;padding:0 12px;border-radius:12px;background:rgba(255,255,255,.07);
  border:1px solid rgba(145,170,220,.16);color:#eaf0ff;outline:0}
.ing-file{height:42px;display:inline-flex;align-items:center;padding:6px 8px;border-radius:12px;
  background:rgba(255,255,255,.07);border:1px solid rgba(145,170,220,.16);color:#eaf0ff}

.ing-row-input{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
.ing-row-input .ing-input{border-top-right-radius:0;border-bottom-right-radius:0}
.ing-row-input .ing-pill{height:42px;display:inline-flex;align-items:center;border-top-left-radius:0;border-bottom-left-radius:0}
</style>

<section class="ing-wrap">
  <header class="ing-h">
    <div>
      <div class="t">Ingest</div>
      <div class="s">Загрузка и отправка в память</div>
    </div>
  </header>

  <!-- Inbox -->
  <div class="ing-card">
    <div class="ing-row">
      <div class="ing-muted">Инбокс</div>
      <div class="ing-actions">
        <button class="ing-pill" hx-get="/ui/ingest/status" hx-target="#inbox" hx-swap="innerHTML">Обновить</button>
        <button class="ing-pill" hx-post="/ui/ingest/commit-all" hx-target="#inbox" hx-swap="innerHTML">В память</button>
        <button class="ing-pill" hx-delete="/ui/ingest/clear" hx-target="#inbox" hx-swap="innerHTML">Очистить</button>
      </div>
    </div>
    <pre id="inbox" class="ing-pre">жду…</pre>
  </div>

  <!-- Upload -->
  <div class="ing-card">
    <form id="ingest-form" hx-post="/ingest" hx-encoding="multipart/form-data" hx-target="#upload-resp" hx-swap="innerHTML">
      <div class="ing-grid ing-two" style="margin-bottom:10px">
        <label>
          <div class="ing-label">Файл(ы)</div>
          <input type="file" id="files" name="files" class="ing-file" multiple> <button type="button" id="btn-upload" class="ws-badge" onclick="uploadFiles()">Загрузить файл(ы)</button>
        </label>
        <div>
          <div class="ing-label">URL</div>
          <div class="ing-row-input">
            <input type="url" id="url" name="url" class="ing-input" placeholder="https://...">
            <button type="submit" class="ing-pill">Загрузить</button>
          </div>
        </div>
      </div>
      <div class="ing-muted">Поддерживаемые: PDF, TXT, MD, DOCX</div>
    </form>
    <div style="margin-top:10px"><pre id="upload-resp" class="ing-pre">готов к загрузке…</pre></div>
  </div>
</section>
{% endblock %}
